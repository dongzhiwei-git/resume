    <!-- Apply dynamic styles -->
    <div class="resume-preview template-{{ .Resume.Config.Template }} font-size-{{ .Resume.Config.FontSize }} paper-{{ .Resume.Config.PaperSize }}" 
         style="--theme-color: {{ .Resume.Config.Color }}; background: white; padding: 3rem; box-shadow: 0 0 15px rgba(0,0,0,0.1); margin: 0 auto;">
        
        <!-- Header -->
        <header class="resume-header">
            {{ if .Resume.Avatar }}
            <div class="avatar-container" style="text-align: center; margin-bottom: 1rem;">
                <img src="{{ .Resume.Avatar }}" alt="Avatar" style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 3px solid var(--theme-color);">
            </div>
            {{ end }}
            <h1 class="name">{{ .Resume.Name }}</h1>
            <div class="contact-info">
                {{ if .Resume.Email }}<span>{{ .Resume.Email }}</span>{{ end }}
                {{ if .Resume.Phone }}<span class="separator">|</span><span>{{ .Resume.Phone }}</span>{{ end }}
            </div>
        </header>

        <!-- Summary -->
        {{ if .Resume.Summary }}
        <section class="resume-section">
            <h3 class="section-title">个人简介</h3>
            <p class="section-content">{{ .Resume.Summary }}</p>
        </section>
        {{ end }}

        <!-- Experience -->
        {{ if .Resume.Experience }}
        <section class="resume-section">
            <h3 class="section-title">工作经历</h3>
            {{ range .Resume.Experience }}
                {{ if .Company }}
                <div class="experience-item">
                    <div class="item-header">
                        <h4 class="item-title">{{ .Title }}</h4>
                        <span class="item-date">{{ .Date }}</span>
                    </div>
                    <div class="item-subtitle">{{ .Company }}</div>
                    <p class="item-description">{{ .Description }}</p>
                </div>
                {{ end }}
            {{ end }}
        </section>
        {{ end }}

        <!-- Education -->
        {{ if .Resume.Education }}
        <section class="resume-section">
            <h3 class="section-title">教育背景</h3>
            {{ range .Resume.Education }}
                {{ if .School }}
                <div class="education-item">
                    <div class="item-header">
                        <h4 class="item-title">{{ .School }}</h4>
                        <span class="item-date">{{ .Date }}</span>
                    </div>
                    <div class="item-subtitle">{{ .Degree }}</div>
                </div>
                {{ end }}
            {{ end }}
        </section>
        {{ end }}

    </div>

<style>
/* Base Styles for Preview */
.resume-preview {
    font-family: 'Helvetica Neue', Helvetica, Arial, "Microsoft YaHei", sans-serif;
    color: #333;
    line-height: 1.6;
}

.resume-header {
    margin-bottom: 2rem;
    border-bottom: 2px solid var(--theme-color);
    padding-bottom: 1.5rem;
    text-align: center;
}

.resume-header .name {
    margin: 0;
    font-size: 2.5rem;
    color: var(--theme-color);
    text-transform: uppercase;
}

.resume-header .contact-info {
    margin-top: 0.5rem;
    color: #555;
}

.section-title {
    color: var(--theme-color);
    text-transform: uppercase;
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
    margin-bottom: 1rem;
    font-size: 1.2rem;
}

.section-content {
    white-space: pre-wrap;
}

.item-description {
    white-space: pre-wrap;
}

.experience-item, .education-item {
    margin-bottom: 1.5rem;
}

.item-header {
    display: flex; 
    justify-content: space-between; 
    align-items: baseline;
}

.item-title {
    margin: 0;
    font-size: 1.1rem;
    color: #222;
    font-weight: bold;
}

.item-date {
    font-style: italic; 
    color: #666; 
    font-size: 0.9rem;
}

.item-subtitle {
    font-weight: bold; 
    color: #555; 
    margin-bottom: 0.5rem;
}

/* Font Size Variants */
.font-size-small { font-size: 14px; }
.font-size-small .name { font-size: 2rem; }
.font-size-medium { font-size: 16px; }
.font-size-large { font-size: 18px; }
.font-size-large .name { font-size: 3rem; }

/* Paper Size Variants */
.paper-a4 {
    width: 210mm;
    min-height: 297mm;
    max-width: 100%;
}
.paper-letter {
    width: 216mm; /* 8.5in */
    min-height: 279mm; /* 11in */
    max-width: 100%;
}

/* Template: Modern */
.template-modern .resume-header {
    text-align: left;
    border-bottom: none;
    background: var(--theme-color);
    color: white;
    padding: 2rem;
    margin: -3rem -3rem 2rem -3rem; /* Bleed to edge */
}
.template-modern .resume-header .name {
    color: white;
}
.template-modern .resume-header .contact-info {
    color: rgba(255,255,255,0.9);
}
.template-modern .section-title {
    border-bottom: 2px solid var(--theme-color);
    display: inline-block;
    padding-right: 1rem;
}

/* Template: Minimal */
.template-minimal .resume-header {
    border-bottom: none;
    text-align: left;
}
.template-minimal .resume-header .name {
    font-weight: 300;
    letter-spacing: 2px;
}
.template-minimal .section-title {
    border-bottom: none;
    font-weight: bold;
    letter-spacing: 1px;
    background: #f4f4f4;
    padding: 5px 10px;
    border-radius: 4px;
}

@media print {
    body { background: white; }
    .no-print { display: none !important; }
    nav, footer { display: none !important; }
    .container { padding: 0 !important; margin: 0 !important; max-width: 100% !important; }
    .resume-preview { box-shadow: none !important; margin: 0 !important; padding: 0 !important; width: 100% !important; }
    /* Handle Modern Template Print bleed */
    .template-modern .resume-header { margin: 0 0 2rem 0; }
}
</style>
